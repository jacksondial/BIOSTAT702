---
title: "Homework 6"
author: "Jackson Dial"
date: "10/26/2021"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Question 1

### Part A

How much power would there be to detect the clinically relevant difference at the 0.05 significance level, if 20 individuals who spike in PF4 and 20 individuals who do not spike in PF4 are enrolled? Show some methodology for full credit.

```{r}
MyPwrFun <- function(alpha, m1, m2, s1, s2, n1, n2){
  z1a2 <- qnorm(1 - alpha / 2)
  za2 <- qnorm(alpha / 2)
  quant <- (m1-m2) / sqrt( (s1^2/n1) + (s2^2/n2) )
  beta <- pnorm(z1a2 - quant) - pnorm(za2 - quant)
  power <- 1- beta
  return(power)
}

power1 <- MyPwrFun(alpha = .05, m1 = 1, m2 = .8, s1 = .32, s2 = .04, n1 = 20, n= 20)
```

The power for this scenario would be `r round(power1,2)`. 

### Part B

Power is the probability of rejecting the null hypothesis when the alternative hypothesis is true. It is affected by variability, and as variability increases, power decreases.If we enroll more individuals in the population with more variability, that normalizes the variance of that group by a larger value, reducing variability, given that we have assumed normally distributed source populations.

### Part C

```{r}
pwrdf <- data.frame()
for (x in 0:40){
  powers <- MyPwrFun(alpha = .05, m1 = 1, m2 = .8, s1= .32, s2 = .04, n1 = x, n2 = 40-x)
  pwrdf <- rbind(pwrdf, c(x, powers))
}
```


A sample split of 36-4 observations per group would yield us the highest power, with power being calculated as 0.9396 for that split.

## Quuestion 2

### Part 1

```{r}
MyPwrFun2 <- function(p1, p2, alpha, p.bar, n1, n2){
  z1a2 <- qnorm(alpha)
  d <- abs(p1-p2)
  quant <- (d - (z1a2 * sqrt(p.bar * (1 - p.bar) ( (1/n1) + (1/n2) ) ) ) ) / (sqrt(((p1 * (1-p1) ) / n1) + (p2 * (1-p2) / n2)))
  pnorm(quant)
}





```




